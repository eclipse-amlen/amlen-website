<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-us"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="copyright" content="(C) Copyright 2022"><meta name="generator" content="DITA-OT"><meta name="description" content=""><link rel="stylesheet" type="text/css" href="../../commonltr.css"><link rel="stylesheet" type="text/css" href="../../doc.css"><title>Create or update a connection policy</title></head><body id="pdf_REST_create_update_conpol"><nav role="toc"><ul><li><a href="../../welcome.html">Welcome</a></li><li><a href="../../Overview/ov00000_.html">Eclipse Amlen</a><ul><li><a href="../../Overview/ov00000_.html">Product overview</a></li><li><a href="../../Planning/pl00001_.html">Planning</a></li><li><a href="../../QuickStartGuide/qsg10000.html">Installing Eclipse Amlen  </a></li><li><a href="../../Upgrading/up00001_.html">Upgrading</a></li><li><a href="../../Scenarios/sc00000_.html">End-to-end scenarios</a></li><li><a href="../../Administering/ad00000_.html">Administering</a></li><li><a href="../../AdministeringWebUI/ad00002_.html">Administering the Web UI</a></li><li><a href="../../Bridge/br00010.html">Configuring the Bridge</a></li><li><a href="../../Security/se00000_.html">Security</a></li><li><a href="../../Monitoring/admin00008_.html">Monitoring and reporting</a></li><li><a href="../../Backup/ba00000_.html">Backup and restore</a></li><li><a href="../../Troubleshooting/tr10000_.html">Troubleshooting</a></li><li><a href="../../Developing/develop_guide.html">Developing client applications</a></li><li><a href="../../Reference/re00000_.html">Reference</a><ul><li><a href="../../Reference/intro.html">REST API Reference</a><ul><li><a href="../../Reference/cmd_delete_config.html">Delete configuration objects</a></li><li><a href="../../Reference/cmd_show_config.html">Show configuration details of nameable configuration objects</a></li><li><a href="../../Reference/cmd_show_config_fix.html">Show configuration details of fixed-name configuration objects</a></li><li><a href="../../Reference/cmd_REST_file_put.html">Copy a file from the local machine to Eclipse Amlen  </a></li><li><a href="../../Reference/AdminEndpointCmd/adminendpoint.html">Admin endpoint REST Administration APIs</a></li><li><a href="../../Reference/ApplianceCmd/appliancesettingcommands.html">Server REST Administration APIs</a></li><li><a href="../../Reference/ClusterCmd/clustercommands.html">Cluster REST Administration APIs</a></li><li><a href="../../Reference/SecurityCmd/securitycommands.html">Security REST Administration APIs</a></li><li><a href="../../Reference/MsgHubCmd/messagehubcommands.html">Message hub REST Administration APIs</a><ul><li class="active"><a href="../../Reference/MsgHubCmd/cmd_create_update_conpol.html">Create or update a connection policy</a></li><li><a href="../../Reference/MsgHubCmd/cmd_create_update_endpoint.html">Create or update an endpoint</a></li><li><a href="../../Reference/MsgHubCmd/cmd_create_update_msghub.html">Create or update a message hub</a></li><li><a href="../../Reference/MsgHubCmd/cmd_create_update_topicpol.html">Create or update a topic policy</a></li><li><a href="../../Reference/MsgHubCmd/cmd_create_update_subscriptionpol.html">Create or update a subscription policy</a></li><li><a href="../../Reference/MsgHubCmd/cmd_create_update_queuepol.html">Create or update a queue policy</a></li></ul></li><li><a href="../../Reference/QueueCmd/QueueCmd.html">Queue REST Administration APIs</a></li><li><a href="../../Reference/MQConnCmd/mqconnectivitycommands.html">MQ Connectivity  REST Administration APIs</a></li><li><a href="../../Reference/HACmd/HAcommands.html">High availability REST Administration APIs</a></li><li><a href="../../Reference/BackupCmd/backupandrestorecommands.html">Backup and restore commands</a></li><li><a href="../../Reference/MonitorCmd/monitoringandreportingcommands.html">REST Monitoring APIs</a></li><li><a href="../../Reference/XATranCmd/xatransactioncommands.html">XA transaction REST Administration APIs</a></li><li><a href="../../Reference/SNMPCmd/snmpcommands.html">SNMP REST Administration APIs</a></li><li><a href="../../Reference/ProtocolPluginCmd/ProtocolPluginCmd.html">Protocol plug-in REST Administration APIs</a></li><li><a href="../../Reference/SpecialCmd/spepcom.html">Special purpose REST Administration APIs</a></li></ul></li><li><a href="../../Reference/_Topics/sy10530_.html">Digital certificates</a></li><li><a href="../../Reference/_Topics/re00003_.html">Supported cipher lists</a></li><li><a href="../../Reference/_Topics/re00001_.html">Classless Inter-Domain Routing</a></li></ul></li><li><a href="../../glossary/glossary.html">Glossary</a></li></ul></li></ul></nav><main role="main"><article role="article" aria-labelledby="ariaid-title1">
<h1 class="title topictitle1" id="ariaid-title1">Create or update a connection policy</h1>
  
<div class="body refbody"><p class="shortdesc"></p>
<section class="section"><h2 class="title sectiontitle">Purpose</h2>Creates a connection policy. A connection policy is used to authorize
      a connection to <span class="ph">Eclipse Amlen</span> based on one or more
      connection level attributes.</section>
<section class="section"><h2 class="title sectiontitle">URI</h2>

<p class="p">Use the <span class="ph">Eclipse Amlen</span> REST API POST method with the
        following <span class="ph">Eclipse Amlen</span> configuration URI:</p>
<p class="p"><code class="ph codeph">http://&lt;admin-endpoint-IP:Port&gt;/ima/v1/configuration/</code></p>
</section>
<section class="section"><h2 class="title sectiontitle">Object configuration data</h2><p class="p">Provide ConnectionPolicy object configuration
data in the payload of the POST method by using the following schema.
<span class="keyword parmname">Content-type</span> is set to <kbd class="ph userinput">application/json</kbd>: </p><pre class="pre codeblock"><code>
{    
  "ConnectionPolicy": {
    "&lt;NameOfConnectionPolicy&gt;": {
      "Description": "string",
      "AllowDurable": true|false,
      "AllowPersistentMessages": true|false,
      "ClientID": "string",
      "ClientAddress": "string",
      "UserID": "string",
      "GroupID": "string",
      "CommonNames": "string",
      "Protocol": "string",
      "MaximumSessionExpiryInterval" : "string",
      "ExpectedMsgRate" : "string"
     }
   }
}</code></pre>Where:<dl class="dl">

<dt class="dt dlterm"><var class="keyword varname">NameOfConnectionPolicy</var></dt>
<dd class="dd">Required.</dd>
<dd class="dd ddexpand">Specifies the name of the connection policy.</dd>
<dd class="dd ddexpand">The name must not have leading or trailing spaces and cannot contain control characters, commas,
double quotation marks, backslashes, or equal signs. The first character must not be a number or any
of the following special characters: <p class="p"><code class="ph codeph">! # $ % &amp; ' ( ) * + - . / : ; &lt; &gt; ?
@</code></p>
</dd>
<dd class="dd ddexpand">The maximum length of the name is 256 characters. </dd>
<dd class="dd ddexpand">After the connection policy is created, you cannot change this name.</dd>


<dt class="dt dlterm">Description</dt>
<dd class="dd">Optional.</dd>
<dd class="dd ddexpand">Specifies a description for the connection policy.</dd>
<dd class="dd ddexpand">If you do not want a description, omit <code class="ph codeph">"Description":"<em class="ph i">description</em>"</code>.</dd>


<dt class="dt dlterm">AllowDurable: true|false</dt>
<dd class="dd">Optional.</dd>
<dd class="dd ddexpand">Specifies whether MQTT clients can connect using a setting of <code class="ph codeph">cleanSession=0</code>
(true) or not (false).</dd>
<dd class="dd ddexpand">The default value is true.</dd>
<dd class="dd ddexpand">This value is applied only when the protocol that is being used is MQTT.</dd>


<dt class="dt dlterm">AllowPersistentMessages: true|false</dt>
<dd class="dd">Optional.</dd>
<dd class="dd ddexpand">Specifies whether MQTT clients can publish messages with a QoS of 1 or 2 (true) or not
(false).</dd>
<dd class="dd ddexpand">The default value is true.</dd>
<dd class="dd ddexpand">This value is applied only when the protocol that is being used is MQTT.</dd>

</dl><div class="p">Specify at least one of the following filters:<dl class="dl">

<dt class="dt dlterm">ClientID</dt>
<dd class="dd">Specifies the client ID that is allowed to connect to <span class="ph">Eclipse Amlen</span>.</dd>
<dd class="dd ddexpand">You can use an asterisk (*) at the end of the value to match 0 or more characters.</dd>
<dd class="dd ddexpand">You can use variable substitution in the client ID to ensure that only clients with a client ID
that matches the user ID or the certificate common name, can connect. The variable for user IDs is
<code class="ph codeph">${UserID}</code>. The variable for certificate common name is
<code class="ph codeph">${CommonName}</code>. You can specify extra characters along with the variable. For
example, you can specify that the client ID must match <code class="ph codeph">myClient/${UserID}</code>. In this
case, a client with the user ID <code class="ph codeph">userA</code> and the client ID
<code class="ph codeph">myClient/userA</code> can connect. A client with the user ID <code class="ph codeph">userB</code> and
the client ID <code class="ph codeph">myClient/userB</code> can connect. However, a client with the user ID
<code class="ph codeph">userB</code> and the client ID <code class="ph codeph">notMyClient</code> cannot connect.</dd>
<dd class="dd ddexpand">To use the default value, where all client ID values are allowed to connect, omit
<code class="ph codeph">"ClientID": "<var class="keyword varname">clientID</var>"</code>.</dd>


<dt class="dt dlterm">ClientAddress</dt>
<dd class="dd">Specifies the client IP addresses that are allowed to connect to <span class="ph">Eclipse Amlen</span>.</dd>
<dd class="dd ddexpand">The IP address can contain an asterisk (*), or a comma-separated list of IPv4 or IPv6 addresses
or ranges. For example, 192.0.2.32, 192.0.0.0, 192.0.2.0-192.0.2.100. The range must be specified
from low to high.</dd>
<dd class="dd ddexpand">However, each IPv6 address must be enclosed in brackets <code class="ph codeph">[ ]</code> either when
expressed singly or in a range of addresses. IPv6 addresses cannot contain asterisks.</dd>
<dd class="dd ddexpand">The maximum number of client addresses that you can specify is 20.</dd>
<dd class="dd ddexpand">To use the default value, where all client IP addresses are allowed to connect, omit
<code class="ph codeph">"ClientAddress": "<var class="keyword varname">IP_Address</var>"</code> or specify
<code class="ph codeph">"ClientAddress":"<em class="ph i">*</em>"</code>.</dd>


<dt class="dt dlterm">UserID</dt>
<dd class="dd">Specifies the messaging user ID that is allowed to connect to <span class="ph">Eclipse Amlen</span>.</dd>
<dd class="dd ddexpand">You can use an asterisk (*) at the end of the value to match 0 or more characters.</dd>
<dd class="dd ddexpand">To use the default value, where all user ID values are allowed to connect, omit
<code class="ph codeph">"UserID": "<var class="keyword varname">UserID</var>"</code>.</dd>


<dt class="dt dlterm">GroupID</dt>
<dd class="dd">Optional.</dd>
<dd class="dd ddexpand">Specifies the messaging group that is allowed to connect to <span class="ph">Eclipse Amlen</span>.</dd>
<dd class="dd ddexpand">You can use an asterisk (*) at the end of the value to match 0 or more characters.</dd>
<dd class="dd ddexpand">To use the default value, where all groups are allowed to connect, omit <code class="ph codeph">"GroupID":
"<var class="keyword varname">GroupID</var>"</code>.</dd>


<dt class="dt dlterm">CommonNames</dt>
<dd class="dd">Specifies the client certificate common name that must be used to connect to <span class="ph">Eclipse Amlen</span>.</dd>
<dd class="dd ddexpand">You can use an asterisk (*) at the end of the value to match 0 or more characters.</dd>
<dd class="dd ddexpand">To use the default value, where all client certificates are allowed to connect, omit
<code class="ph codeph">"CommonNames": "<var class="keyword varname">CommonNames</var>"</code>.</dd>


<dt class="dt dlterm">Protocol</dt>
<dd class="dd">Specifies which protocols are allowed to connect to <span class="ph">Eclipse Amlen</span>.</dd>
<dd class="dd ddexpand">You can choose from JMS and MQTT protocols. If there are any protocol plug-ins installed on the
<span class="ph">Eclipse Amlen</span> server, you can specify these as well. To
specify more than one value, separate each value with a comma. To select all protocols, specify a
null value for Protocol or omit the parameter from the command.</dd>
<dd class="dd ddexpand">To specify more than one value, separate each value with a comma.</dd>


<dt class="dt dlterm">MaximumSessionExpiryInterval</dt>
<dd class="dd">Optional.</dd>
<dd class="dd ddexpand">Specifies the maximum time, in seconds, that a session is kept alive before expiring.</dd>
<dd class="dd ddexpand">The value must be either <code class="ph codeph">unlimited</code>, or in the range 1-2147483647.</dd>
<dd class="dd ddexpand">The default value is <code class="ph codeph">unlimited</code> and means that a session will not expire.</dd>


<dt class="dt dlterm">ExpectedMsgRate</dt>
<dd class="dd">Optional.</dd>
<dd class="dd ddexpand">Specifies the expected throughput of messages.</dd>
<dd class="dd ddexpand">Valid values are <code class="ph codeph">Low</code>, <code class="ph codeph">Default</code>, <code class="ph codeph">High</code>,
<code class="ph codeph">Max</code>.</dd>
<dd class="dd ddexpand">The default value is <code class="ph codeph">Default</code>.</dd>
<dd class="dd ddexpand">A value of  <code class="ph codeph">Low</code> might be used for a throughput of less than 10 messages per
second, a value of <code class="ph codeph">Max</code> might be used for a throughput of more than a few thousand
messages per second.</dd>
<dd class="dd ddexpand">When selecting the value, consider factors such as the latency of the connection, and the size
and number of devices. If you have many devices, you might want to use a lower setting in order to
save memory. </dd>

</dl></div></section>
<section class="section"><h2 class="title sectiontitle">Usage Notes®</h2>

<ul class="ul">
        <li class="li">Capitalization and double quotation marks must be used as shown.</li>
<li class="li">Each of the filters, <span class="keyword parmname">ClientAddress</span>, <span class="keyword parmname">ClientID</span>, <span class="keyword parmname">UserID</span>, <span class="keyword parmname">GroupID</span>, <span class="keyword parmname">CommonNames</span>, and <span class="keyword parmname">Protocol</span>, is applied in combination. If you specify several filters, each condition must be met in order for the client to connect to <span class="ph">Eclipse Amlen</span>. For each filter that you do not specify, all values for that filter are allowed.<p class="p">For example, a connection policy is created that specifies: <code class="ph codeph">"GroupID": "SILVER" "UserID": "SIL*" "Protocol": "JMS"</code>. A client with User ID <code class="ph codeph">SIL1</code>, in group <code class="ph codeph">SILVER</code>, that is using JMS can connect. A client with a User ID <code class="ph codeph">SIL2</code>, in group <code class="ph codeph">GOLD</code>, that is using JMS cannot connect because not all of the filter conditions are met.</p></li>
</ul>
</section>
<section class="section"><h2 class="title sectiontitle">Related <span class="ph">REST Administration APIs</span></h2>

      <ul class="ul">
        <li class="li"><a class="xref" href="cmd_create_update_msghub.html">Create or update a message hub</a></li>
        <li class="li"><a class="xref" href="cmd_create_update_topicpol.html">Create or update a topic policy</a></li>
        <li class="li"><a class="xref" href="cmd_create_update_subscriptionpol.html">Create or update a subscription policy</a></li>
        <li class="li"><a class="xref" href="cmd_create_update_queuepol.html">Create or update a queue policy</a></li>
        <li class="li"><a class="xref" href="cmd_create_update_endpoint.html">Create or update an endpoint</a></li>
        <li class="li"><a class="xref" href="../cmd_show_config.html">Show configuration details of nameable configuration objects</a></li>
        <li class="li"><a class="xref" href="../cmd_delete_config.html">Delete configuration objects</a></li>
      </ul>
</section>
<section class="section"><h2 class="title sectiontitle">Example</h2>Creates a connection policy called "MyConnectionPolicy" by using cURL:<pre class="pre codeblock"><code>
curl -X POST \
   -H  'Content-Type: application/json'  \
   -d  '{                       
           "ConnectionPolicy": {   
             "MyConnectionPolicy": {
               "Description": "Connection policy to authorize connection from demo client.",
               "ClientID": "*"
              }
          }
      }
  '   \
http://127.0.0.1:9089/ima/v1/configuration/</code></pre><div class="p">An example response to the POST method:<pre class="pre codeblock"><code>
{        
  "Version": "v1",
  "Code": "CWLNA6011",
  "Message": "The requested configuration change has completed successfully."
}
</code></pre></div></section>
</div>
<nav role="navigation" class="related-links"><div class="familylinks"><div class="parentlink"><strong>Parent topic:</strong> <a class="link" href="../../Reference/MsgHubCmd/messagehubcommands.html" title="The message hub REST APIs allow you to configure message hubs, endpoints, connection policies, and messaging policies. You can create, update, view, and delete message hubs, endpoints, connection policies, and messaging policies.">Message hub REST Administration APIs</a></div></div></nav></article></main></body></html>