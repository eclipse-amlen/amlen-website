<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-us"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="copyright" content="(C) Copyright 2021"><meta name="generator" content="DITA-OT"><meta name="description" content="System administrators can create and update destination mapping rules by using the REST Administration APIs."><link rel="stylesheet" type="text/css" href="../commonltr.css"><link rel="stylesheet" type="text/css" href="../doc.css"><title>Creating and updating a destination mapping rule by using REST Administration APIs</title></head><body id="ad00123_new"><nav role="toc"><ul><li><a href="../welcome.html">Welcome</a></li><li><a href="../Overview/ov00000_.html">Eclipse Amlen</a><ul><li><a href="../Overview/ov00000_.html">Product overview</a></li><li><a href="../Planning/pl00001_.html">Planning</a></li><li><a href="../QuickStartGuide/qsg10000.html">Installing Eclipse Amlen  </a></li><li><a href="../Upgrading/up00001_.html">Upgrading</a></li><li><a href="../Scenarios/sc00000_.html">End-to-end scenarios</a></li><li><a href="../Administering/ad00000_.html">Administering</a><ul><li><a href="../Administering/ad00390_.html">Configuring the administration endpoint</a></li><li><a href="../Administering/ad00200_.html">Server administration</a></li><li><a href="../Administering/ad00370_.html">Configuring LDAP for user authentication</a></li><li><a href="../Administering/ad00700_.html">Configuring security</a></li><li><a href="../Administering/dv00010.html">Configuring protocol plug-ins</a></li><li><a href="../Administering/ad00360_.html">Configuring message hubs</a></li><li><a href="../Administering/ad00350_.html">Configuring message queues</a></li><li><a href="../Administering/ad00940_.html">Configuring the cluster membership of an Eclipse Amlen server</a></li><li><a href="../Administering/ad00850_.html">Configuring disconnected client notifications</a></li><li><a href="../Administering/ad02940_.html">Configuring administrative subscriptions </a></li><li><a href="../Administering/ad00111.html">Deleting a ClientSet by using a REST Administration API</a></li><li><a href="../Administering/ad00510_.html">Configuring SNMP</a></li><li><a href="../Administering/ad01326_.html">Configuring certificate revocation lists</a></li><li><a href="../Administering/ad00460_.html">Viewing and deleting configuration objects by using REST Administration APIs</a></li><li><a href="../Administering/ad00929.html">Managing multiple Eclipse Amlen servers from a single Amlen WebUI</a></li><li><a href="../Administering/ad00100_.html">Working with external resources</a><ul><li><a href="../Administering/ad00102_.html">MQ Connectivity</a><ul><li><a href="../Administering/ad00092_.html">MQ Connectivity throughput and message order</a></li><li><a href="../Administering/ad00101_.html">MQ Connectivity message persistence</a></li><li><a href="../Administering/ad00132_.html">MQ Connectivity retained messages</a></li><li><a href="../Administering/ad00103_.html">MQ Connectivity and high availability</a></li><li><a href="../Administering/ad00104_.html">MQ Connectivity security</a></li><li><a href="../Administering/ad00091_.html">Configuring the IBM MQ server connection channel</a></li><li><a href="../Administering/ad00105_.html">Configuring the MQ Connectivity SSL key repository</a></li><li><a href="../Administering/ad00113_.html">Configuring queue manager connections</a></li><li><a href="../Administering/ad00110_.html">Configuring destination mapping rules</a><ul><li><a href="../Administering/ad00114_.html">Configuring destination mapping rules by using the Amlen WebUI</a></li><li><a href="../Administering/ad00115_.html">Configuring destination mapping rules by using REST Administration APIs</a><ul><li class="active"><a href="../Administering/ad00123_.html">Creating and updating a destination mapping rule by using REST Administration APIs</a></li><li><a href="../Administering/ad00128_.html">Viewing a destination mapping rule by using REST Administration APIs</a></li><li><a href="../Administering/ad00099_.html">Viewing the status of destination mapping rules by using REST Administration APIs</a></li></ul></li></ul></li><li><a href="../Administering/ad00129_.html">Starting, restarting, stopping, and viewing the status of MQ Connectivity</a></li><li><a href="../Administering/ad00111_.html">MQ Connectivity scenarios</a></li></ul></li><li><a href="../Administering/workingwithjmsra.html">Eclipse Amlen resource adapter</a></li><li><a href="../Administering/vm00001_.html">Using VMware vSphere to handle Eclipse Amlen failover</a></li></ul></li><li><a href="../Administering/ad00920.html">HTTP status codes</a></li></ul></li><li><a href="../AdministeringWebUI/ad00002_.html">Administering the Web UI</a></li><li><a href="../Bridge/br00010.html">Configuring the Bridge</a></li><li><a href="../Security/se00000_.html">Security</a></li><li><a href="../Monitoring/admin00008_.html">Monitoring and reporting</a></li><li><a href="../Backup/ba00000_.html">Backup and restore</a></li><li><a href="../Troubleshooting/tr10000_.html">Troubleshooting</a></li><li><a href="../Developing/develop_guide.html">Developing client applications</a></li><li><a href="../Reference/re00000_.html">Reference</a></li><li><a href="../glossary/glossary.html">Glossary</a></li></ul></li></ul></nav><main role="main"><article role="article" aria-labelledby="ariaid-title1">
 <h1 class="title topictitle1" id="ariaid-title1">Creating and updating a destination mapping rule by using <span class="ph">REST Administration APIs</span></h1>
 
 <div class="body taskbody"><p class="shortdesc">System administrators can create and update destination mapping rules by using the <span class="ph">REST Administration APIs</span>.</p>
    <section class="section prereq">
      <p class="p">Before you can create a destination mapping rule, you must create the queue manager
        connection that you want to use in the rule. For more information about creating a queue
        manager connection, see <a class="xref" href="ad00113_.html" title="To connect Eclipse Amlen to IBM MQ queue managers, you must create queue manager connections. Each queue manager connection specifies the connection details for one queue manager.">Configuring queue manager connections</a>.</p>
    </section>
  <section class="section context">You can create and update a destination mapping rule by using a <span class="ph">REST Administration API</span>, or by using the <span class="ph">Amlen WebUI</span>. For more information about using the <span class="ph">Amlen WebUI</span> to create or update a destination mapping rule, see <a class="xref" href="ad00114_.html" title="System administrators and messaging administrators can configure destination mapping rules by using the MQ Connectivity page in the Amlen WebUI.">Configuring destination mapping rules by using the Amlen WebUI</a>.<div class="note note note_note"><span class="note__title">Note:</span> You must disable a destination mapping rule before you can make any changes to that rule. After editing, you must enable the destination mapping rule in order for the changes that you made to take effect. To edit a queue manager connection, all destination mapping rules that use that queue manager connection must be disabled. You do not need to restart the mqconnectivity process in order for any changes to take effect.</div></section>
  <section><ol class="ol steps"><li class="li step stepexpand">
        <span class="ph cmd">To create or update a destination mapping rule, use the <span class="ph">Eclipse Amlen</span> REST API POST method with the following <span class="ph">Eclipse Amlen</span> configuration URI:</span>
        <div class="itemgroup info">
          <p class="p"><code class="ph codeph">http://&lt;admin-endpoint-IP:Port&gt;/ima/v1/configuration/</code></p>
        </div>
      </li><li class="li step stepexpand">
        <span class="ph cmd">Provide DestinationMappingRule object configuration data in the payload of the POST method by using the following schema. <span class="keyword parmname">Content-type</span> is set to <kbd class="ph userinput">application/json</kbd>.  Ensure that capitalization and double quotation marks are used as shown.</span>
        <div class="itemgroup info"><pre class="pre codeblock"><code>
{    
  "DestinationMappingRule": {
    "&lt;NameOfDestinationMappingRule&gt;": {
      "QueueManagerConnection": "string",
      "Enabled": true|false,
      "RuleType": integer,
      "Source": "string",
      "Destination": "string",
      "MaxMessages": integer,

      "RetainedMessages": true|false           
     }
   }
}</code></pre>Where:<ul class="ul">
            <li class="li">
              <dl class="dl">
                
                  <dt class="dt dlterm"><var class="keyword varname">NameOfDestinationMappingRule</var></dt>
                  <dd class="dd">Specifies the name of the destination mapping rule. After the destination
                    mapping rule is created, you cannot change this name.</dd>
                  <dd class="dd ddexpand">The name must not have leading or trailing spaces and cannot contain control
                    characters, commas, double quotation marks, backslashes, or equal signs. The
                    first character must not be a number or any of the following special characters:
                        <p class="p"><code class="ph codeph">! # $ % &amp; ' ( ) * + - . / : ; &lt; &gt; ? @</code></p></dd>
                
              </dl>
            </li>
            <li class="li">
              <dl class="dl">
                
                  <dt class="dt dlterm">QueueManagerConnection</dt>
                  <dd class="dd">Specifies the name of one or more queue manager connections. The queue manager
                    connections identify which queue managers the rule maps to. You can specify more
                    than one queue manager connection by using a comma-separated list.</dd>
                  <dd class="dd ddexpand">To preserve the order of the messages, you must use only one queue manager
                    connection for each destination mapping rule. If you create multiple destination
                    mapping rules with the same destination, but which use different queue manager
                    connections, the message order is not preserved.</dd>
                
              </dl>
            </li>
            <li class="li">
              <dl class="dl">
                
                  <dt class="dt dlterm">Enabled=true|false</dt>
                  <dd class="dd">Specifies whether the rule is enabled (true) or disabled (false).</dd>
                  <dd class="dd ddexpand">The default value is true.</dd>
                  <dd class="dd ddexpand">To edit a destination mapping rule, the rule must first be disabled. Once all
                    changes are complete, the rule must be enabled for any changes to take effect.
                  </dd>
                
              </dl>
            </li>
            <li class="li">
              <dl class="dl">
                
                  <dt class="dt dlterm">RuleType</dt>
                  <dd class="dd">Specifies the rule type that you want to use. For more information about the
                    values that you can use, see <a class="xref" href="ad00110_.html" title="To send messages between Eclipse Amlen and IBM MQ, you must create destination mapping rules. Destination mapping rules are created by associating an Eclipse Amlen topic or queue with a IBM MQ topic or queue. You can create a maximum of 64 destination mapping rules.">Configuring destination mapping rules</a>.</dd>
                
              </dl>
            </li>
            <li class="li">
              <dl class="dl">
                
                  <dt class="dt dlterm">Source</dt>
                  <dd class="dd">Specifies the source topic string or queue for the rule.</dd>
                  <dd class="dd ddexpand">The source that is specified must follow the naming rules for the source
                    type.</dd>
                  <dd class="dd ddexpand">For <span class="ph">IBM MQ</span> queues, the value can
                    contain characters in the ranges a-z, A-Z, and 0-9, and any of the following
                      characters:<code class="ph codeph">% . / _</code></dd>
                  <dd class="dd ddexpand">For <span class="ph">Eclipse Amlen</span>, the value must not
                    have leading or trailing spaces and cannot contain control characters, commas,
                    double quotation marks, backslashes or equal signs. The first character must not
                    be a number, quotation mark, or any of the following special characters:
                        <p class="p"><code class="ph codeph">! # $ % &amp; ( ) * + , - . / : ; &lt; = &gt; ? @"</code></p></dd>
                
              </dl>
            </li>
            <li class="li">
              <dl class="dl">
                
                  <dt class="dt dlterm">Destination</dt>
                  <dd class="dd">Specifies the destination topic string or queue for the rule.</dd>
                  <dd class="dd ddexpand">The destination that is specified must follow the naming rules for the
                    destination type.</dd>
                  <dd class="dd ddexpand">For <span class="ph">IBM MQ</span> queues, the value can
                    contain characters in the ranges a-z, A-Z, and 0-9, and any of the following
                      characters:<code class="ph codeph">% . / _</code></dd>
                  <dd class="dd ddexpand">For <span class="ph">Eclipse Amlen</span>, the value must not
                    have leading or trailing spaces and cannot contain control characters, commas,
                    double quotation marks, backslashes or equal signs. The first character must not
                    be a number, quotation mark, or any of the following special characters:
                        <p class="p"><code class="ph codeph">! # $ % &amp; ( ) * + , - . / : ; &lt; = &gt; ? @"</code></p></dd>
                
              </dl>
            </li>
            <li class="li">
              <dl class="dl">
                
                  <dt class="dt dlterm">MaxMessages</dt>
                  <dd class="dd">Optional.</dd>
                  <dd class="dd ddexpand">Specifies the maximum number of messages that can be buffered for the
                    destination mapping rule. </dd>
                  <dd class="dd ddexpand">This option is valid only for destination mapping rules from <span class="ph">Eclipse Amlen</span> topics to <span class="ph">IBM MQ</span>. That is, rule types 1, 2, 5,
                    6, and 7.</dd>
                  <dd class="dd ddexpand">The value must be in the range 1-20000000. The default value is 5000. </dd>
                
              </dl>
            </li>
            <li class="li">
              <dl class="dl">
                
                  <dt class="dt dlterm">RetainedMessages</dt>
                  <dd class="dd">Optional.</dd>
                  <dd class="dd ddexpand">Specifies which messages are forwarded as to a topic as retained
                    messages.</dd>
                  <dd class="dd ddexpand">This parameter overrides the retained message setting of the original message
                    publisher.</dd>
                  <dd class="dd ddexpand">This option is only valid for destination mapping rules that forward messages
                    to a topic or topic subtree.</dd>
                  <dd class="dd ddexpand">This value can be one of the following values:<ul class="ul">
                      <li class="li">
                        <dl class="dl">
                          
                            <dt class="dt dlterm">All</dt>
                            <dd class="dd">All messages are forwarded to the topic as retained messages.</dd>
                          
                        </dl>
                      </li>
                      <li class="li">
                        <dl class="dl">
                          
                            <dt class="dt dlterm">None</dt>
                            <dd class="dd">No messages are forwarded to the topic as retained messages.</dd>
                          
                        </dl>
                      </li>
                    </ul>The default value is None.</dd>
                
              </dl>
            </li>
          </ul></div>
      </li></ol></section>
  <section class="example">
   <p class="p">This example demonstrates creating a destination mapping rule called
     <code class="ph codeph">exampleRule</code>. It uses rule type 1: <span class="ph">Eclipse Amlen</span> topic to <span class="ph">IBM MQ</span> queue.</p>
      <pre class="pre codeblock"><code>
curl -X POST \
   -H 'Content-Type: application/json'  \
   -d  '{     
         "DestinationMappingRule": {
           "exampleRule": {
            "QueueManagerConnection": "MyQMC",
            "Enabled": true,
            "RuleType": 1,
            "Source": "ISMRoot/Level1",
            "Destination": "Queue1",
            "MaxMessages": 7000,
            "RetainedMessages": true           
          }
        } 
      }
 '  \
http://127.0.0.1:9089/ima/v1/configuration/</code></pre>
      <p class="p">The following example shows an example response to the POST method:</p>
      <pre class="pre codeblock"><code>
{        
  "Version": "v1",
  "Code": "CWLNA6011",
  "Message": "The requested configuration change has completed successfully."
}
</code></pre>
  </section>
 </div>
 <nav role="navigation" class="related-links"><div class="linklist relconcepts"><strong>Related concepts</strong><br><ul class="linklist"><li class="linklist"><a class="link" href="ad00102_.html" title="Eclipse Amlen can receive messages that are published to Eclipse Amlen topics, or sent to Eclipse Amlen queues and can forward the messages to IBM MQ queues or topics. Eclipse Amlen can also receive messages that are published to IBM MQ topics, or sent to IBM MQ queues, and can forward the messages to Eclipse Amlen topics or queues.">MQ Connectivity</a></li></ul></div><div class="linklist reltasks"><strong>Related tasks</strong><br><ul class="linklist"><li class="linklist"><a class="link" href="ad00128_.html" title="System administrators can view a destination mapping rule by using REST Administration APIs.">Viewing a destination mapping rule by using REST Administration APIs</a></li><li class="linklist"><a class="link" href="ad00091_.html" title="To send messages between IBM MQ and Eclipse Amlen, you must configure a server connection channel.">Configuring the IBM MQ server connection channel</a></li></ul></div></nav>
 
</article></main></body></html>