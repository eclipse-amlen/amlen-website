<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-us"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="copyright" content="(C) Copyright 2022"><meta name="generator" content="DITA-OT"><meta name="description" content="System administrators can update a certificate on the primary and standby nodes by using REST Administration APIs."><link rel="stylesheet" type="text/css" href="../commonltr.css"><link rel="stylesheet" type="text/css" href="../doc.css"><title>Updating an LDAP certificate in a High Availability environment by using REST Administration APIs</title></head><body id="ad00379_"><nav role="toc"><ul><li><a href="../welcome.html">Welcome</a></li><li><a href="../eclipse_amlen.html">Eclipse Amlen</a><ul><li><a href="../Overview/ov00000_.html">Product overview</a></li><li><a href="../Planning/pl00001_.html">Planning</a></li><li><a href="../QuickStartGuide/qsg10000.html">Installing Eclipse Amlen  </a></li><li><a href="../Upgrading/up00001_.html">Upgrading</a></li><li><a href="../Scenarios/sc00000_.html">End-to-end scenarios</a></li><li><a href="../Administering/ad00000_.html">Administering</a><ul><li><a href="../Administering/ad00390_.html">Configuring the administration endpoint</a></li><li><a href="../Administering/ad00200_.html">Server administration</a></li><li><a href="../Administering/ad00370_.html">Configuring LDAP for user authentication</a><ul><li><a href="../Administering/ad00372_.html">Configuring an LDAP server by using the Amlen WebUI</a></li><li><a href="../Administering/ad00373_.html">Configuring an LDAP server by using REST Administration APIs</a><ul><li><a href="../Administering/ad00378_.html">Importing and applying a certificate for an LDAP connection by using REST Administration APIs</a></li><li class="active"><a href="../Administering/ad00379_.html">Updating an LDAP certificate in a High Availability environment by using REST Administration APIs</a></li><li><a href="../Administering/ad00374_.html">Configuring an LDAP connection by using REST Administration APIs</a></li><li><a href="../Administering/ad00376_.html">Viewing the LDAP connection by using a REST Administration API</a></li></ul></li></ul></li><li><a href="../Administering/ad00700_.html">Configuring security</a></li><li><a href="../Administering/dv00010.html">Configuring protocol plug-ins</a></li><li><a href="../Administering/ad00360_.html">Configuring message hubs</a></li><li><a href="../Administering/ad00350_.html">Configuring message queues</a></li><li><a href="../Administering/ad00940_.html">Configuring the cluster membership of an Eclipse Amlen server</a></li><li><a href="../Administering/ad00850_.html">Configuring disconnected client notifications</a></li><li><a href="../Administering/ad02940_.html">Configuring administrative subscriptions </a></li><li><a href="../Administering/ad00111.html">Deleting a ClientSet by using a REST Administration API</a></li><li><a href="../Administering/ad00510_.html">Configuring SNMP</a></li><li><a href="../Administering/ad01326_.html">Configuring certificate revocation lists</a></li><li><a href="../Administering/ad00460_.html">Viewing and deleting configuration objects by using REST Administration APIs</a></li><li><a href="../Administering/ad00929.html">Managing multiple Eclipse Amlen servers from a single Amlen WebUI</a></li><li><a href="../Administering/ad00100_.html">Working with external resources</a></li><li><a href="../Administering/ad00920.html">HTTP status codes</a></li></ul></li><li><a href="../AdministeringWebUI/ad00002_.html">Administering the Web UI</a></li><li><a href="../Bridge/br00010.html">Configuring the Bridge</a></li><li><a href="../Security/se00000_.html">Security</a></li><li><a href="../Monitoring/admin00008_.html">Monitoring and reporting</a></li><li><a href="../Backup/ba00000_.html">Backup and restore</a></li><li><a href="../Troubleshooting/tr10000_.html">Troubleshooting</a></li><li><a href="../Developing/develop_guide.html">Developing client applications</a></li><li><a href="../Reference/re00000_.html">Reference</a></li><li><a href="../glossary/glossary.html">Glossary</a></li></ul></li></ul></nav><main role="main"><article role="article" aria-labelledby="ariaid-title1">
  <h1 class="title topictitle1" id="ariaid-title1">Updating an LDAP certificate in a High Availability environment by using <span class="ph">REST Administration APIs</span></h1>
  
  <div class="body taskbody"><p class="shortdesc">System administrators can update a certificate on the primary and standby nodes by using <span class="ph">REST Administration APIs</span>.</p>
    <section class="section context">
      <p class="p">In an environment that is configured for High Availability, you must ensure that the new
        certificate that you upload on the primary server is correctly replicated on the standby
        server. In this scenario, server 1 is the primary server and server 2 is the standby.</p>
      <p class="p">You can import a certificate for an LDAP connection by using <span class="ph">REST Administration APIs</span>, or by using the <span class="ph">Amlen WebUI</span>. When you use the <span class="ph">Amlen WebUI</span>, importing the certificate is part of creating an external LDAP connection. For more information about using the <span class="ph">Amlen WebUI</span> to import the certificate, see <a class="xref" href="ad00372_.html" title="System administrators and messaging administrators can configure an LDAP server connection by using the User Authentication page in the Amlen WebUI.">Configuring an LDAP server by using the Amlen WebUI</a>.</p>
      <p class="p">After the certificate is applied, it is automatically renamed to
          <span class="ph filepath">ldap.pem</span>.</p>
    </section>
    <section><ol class="ol steps"><li class="li step stepexpand" id="ad00379___CopyTheCertificateToTheByEnteringTh">
        <span class="ph cmd">On server 1, import the certificate to <span class="ph">Eclipse Amlen</span> by using the <span class="ph">Eclipse Amlen</span> REST API PUT method with the following
            <span class="ph">Eclipse Amlen</span> configuration URI:</span>
        <div class="itemgroup info">
          <p class="p"><code class="ph codeph">curl -X PUT -T &lt;FilePath and FileName&gt; http://&lt;admin-endpoint:port&gt;/ima/v1/file/&lt;FileName&gt;</code></p>
        </div>
      </li><li class="li step stepexpand">
        <span class="ph cmd">On server 1, apply the certificate to the LDAP connection by using the <span class="ph">Eclipse Amlen</span> REST API POST method.</span>
        <ol type="a" class="ol substeps">
          <li class="li substep substepexpand">
            <span class="ph cmd">Use the following <span class="ph">Eclipse Amlen</span> configuration URI:</span>
            <div class="itemgroup info">
              <p class="p"><code class="ph codeph">http://&lt;admin-endpoint-IP:Port&gt;/ima/v1/configuration/</code></p>
            </div>
          </li>
          <li class="li substep substepexpand">
            <span class="ph cmd">Provide object configuration data in the payload of the POST method by using the following schema. Content-type is set to application/json: </span>
            <div class="itemgroup info">
              <pre class="pre codeblock"><code>
{    
  "LDAP": {
    "Certificate&gt;": "string",
    "Overwrite": true|false 
   }
}</code></pre>
              <div class="p">Where:<ul class="ul">
                <li class="li">
                  <dl class="dl">
                    
                      <dt class="dt dlterm">Certificate</dt>
                      <dd class="dd">Specifies the name of the certificate that was imported in step <a class="xref" href="ad00378_.html#ad00378___CopyTheCertificateToTheByEnteringTh">1</a>.</dd>
                    
                  </dl>
                </li>
                <li class="li">
                  <dl class="dl">
                    
                      <dt class="dt dlterm">Overwrite: true|false</dt>
                      <dd class="dd">Optional.</dd>
                      <dd class="dd ddexpand">Specifies whether any existing LDAP connection certificate is overwritten.</dd>
                      <dd class="dd ddexpand">The default value is false.</dd>
                    
                  </dl>
                </li>
                </ul></div>
              <p class="p">New LDAP settings will be used the next time a client or connection is authenticated or authorized.</p>
            </div>
          </li>
        </ol>
      </li><li class="li step stepexpand">
        <span class="ph cmd">On server 2, stop the <span class="ph">Eclipse Amlen</span> server process by using the <span class="ph">Eclipse Amlen</span> REST API POST method with the following <span class="ph">Eclipse Amlen</span> service URI: </span>
        <div class="itemgroup info">
          <p class="p"><code class="ph codeph">http://&lt;admin-endpoint-IP:port&gt;/ima/v1/service/stop</code> </p>
          <p class="p">and wait for the server to stop.</p>
        </div>
      </li><li class="li step stepexpand">
        <span class="ph cmd">On server 2, start the <span class="ph">Eclipse Amlen</span> server process by using the <span class="ph">Eclipse Amlen</span> REST API POST method with the following <span class="ph">Eclipse Amlen</span> service URI: </span>
        <div class="itemgroup info">
          <p class="p"><code class="ph codeph">http://&lt;admin-endpoint-IP:port&gt;/ima/v1/service/start </code></p>
          <p class="p">and wait for the synchronization to complete.</p>
        </div>
      </li><li class="li step stepexpand">
        <span class="ph cmd">On server 1, stop the <span class="ph">Eclipse Amlen</span> server process by using the <span class="ph">Eclipse Amlen</span> REST API POST method with the following <span class="ph">Eclipse Amlen</span> service URI: </span>
        <div class="itemgroup info">
          <p class="p"><code class="ph codeph">http://&lt;admin-endpoint-IP:port&gt;/ima/v1/service/stop</code> </p>
          <p class="p">and wait for the server 1 to stop.</p>
        </div>
      </li><li class="li step stepexpand">
        <span class="ph cmd">On server 1, start the <span class="ph">Eclipse Amlen</span> server process by using the <span class="ph">Eclipse Amlen</span> REST API POST method with the following <span class="ph">Eclipse Amlen</span> service URI: </span>
        <div class="itemgroup info">
          <p class="p"><code class="ph codeph">http://&lt;admin-endpoint-IP:port&gt;/ima/v1/service/start </code></p>
          <p class="p">and wait for the synchronization to complete.</p>
        </div>
        <div class="itemgroup stepresult">
          <p class="p">After steps 1 through 6 are completed, server 2 is now the primary server, and both servers have the new LDAP certificate applied and ready for use. New LDAP settings are used the next time a client or connection is authenticated or authorized.</p>
          <p class="p">You can optionally swap server 1 back as the primary server by completing the following steps:</p>
        </div>
      </li><li class="li step stepexpand"><strong>Optional: </strong>
        <span class="ph cmd">On server 2, stop the <span class="ph">Eclipse Amlen</span> server process by using the <span class="ph">Eclipse Amlen</span> REST API POST method with the following <span class="ph">Eclipse Amlen</span> service URI: </span>
        <div class="itemgroup info">
          <p class="p"><code class="ph codeph">http://&lt;admin-endpoint-IP:port&gt;/ima/v1/service/stop </code> </p>
          <p class="p">and wait for the server to stop.</p>
        </div>
      </li><li class="li step stepexpand"><strong>Optional: </strong>
        <span class="ph cmd">On server 2, start the <span class="ph">Eclipse Amlen</span> server process by using the <span class="ph">Eclipse Amlen</span> REST API POST method with the following <span class="ph">Eclipse Amlen</span> service URI: </span>
        <div class="itemgroup info">
          <p class="p"><code class="ph codeph">http://&lt;admin-endpoint-IP:port&gt;/ima/v1/service/start </code></p>
          <p class="p">and wait for the synchronization to complete.</p>
        </div>
      </li></ol></section>
    
    <section class="example"><p class="p">The following commands are entered on the original primary server. The example shows importing a file called <code class="ph codeph">ldap.pem</code> from the local machine to a staging directory and applying the LDAP certificate on a primary server: </p><pre class="pre codeblock"><code>curl -X PUT -T /certificates/ldap.pem http://127.0.0.1:9089/ima/v1/file/ldap.pem
</code></pre><div class="p">An example response to the PUT method:<pre class="pre codeblock"><code>
       {        
         "Version": "v1",
         "Code": "CWLNA6011",
         "Message": "The requested configuration change has completed successfully."
       }
</code></pre></div>The following example applies the certificate to the LDAP connection by using cURL:<pre class="pre codeblock"><code>
curl -X POST \
   -H 'Content-Type: application/json'  \
   -d  '{
          "LDAP": {   
           "Certificate": "ldap.pem",
           "Overwrite": true          
        }
      }
      '  \
http://127.0.0.1:9089/ima/v1/configuration/</code></pre><div class="p">An example response to the POST method:<pre class="pre codeblock"><code>
{        
  "Version": "v1",
  "Code": "CWLNA6011",
  "Message": "The requested configuration change has completed successfully."
}
</code></pre></div></section>
    <section class="section postreq">After you import and apply the LDAP certificate, you can create the LDAP connection. For more information about creating the LDAP connection by using <span class="ph">REST Administration APIs</span>, see <a class="xref" href="ad00374_.html" title="System administrators can configure an LDAP connection by using REST Administration APIs.">Configuring an LDAP connection by using REST Administration APIs</a>.</section>
  </div>
<nav role="navigation" class="related-links"><div class="familylinks"><div class="parentlink"><strong>Parent topic:</strong> <a class="link" href="../Administering/ad00373_.html" title="System administrators can configure an LDAP server for messaging users and groups by using REST Administration APIs.">Configuring an LDAP server by using REST Administration APIs</a></div></div></nav></article></main></body></html>