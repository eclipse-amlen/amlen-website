<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-us"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="copyright" content="(C) Copyright 2022"><meta name="generator" content="DITA-OT"><meta name="description" content="Ensure that MQTT clients that connect by specifying cleanSession=False always connect to an assigned server in the cluster."><link rel="stylesheet" type="text/css" href="../commonltr.css"><link rel="stylesheet" type="text/css" href="../doc.css"><title>Clustering: Client state</title></head><body id="clusteringclientstate"><nav role="toc"><ul><li><a href="../welcome.html">Welcome</a></li><li><a href="../Overview/ov00000_.html">Eclipse Amlen</a><ul><li><a href="../Overview/ov00000_.html">Product overview</a></li><li><a href="../Planning/pl00001_.html">Planning</a><ul><li><a href="../Planning/pl00030.html">Installation planning</a></li><li><a href="../Planning/ov00101_.html">Messaging patterns</a></li><li><a href="../Planning/pl00010.html">Messaging planning</a></li><li><a href="../Planning/clusteringconsiderations.html">Clustering considerations</a><ul><li><a href="../Planning/clusteringsubscriptionvis.html">Clustering: In a request-response model</a></li><li><a href="../Planning/clusteringretainedmsgs.html">Clustering: Retained messages</a></li><li><a href="../Planning/clusteringtimeserversynch.html">Clustering: Time server synchronization</a></li><li><a href="../Planning/clusteringmsgsbetweenservers.html">Clustering: Sending messages between cluster servers</a></li><li><a href="../Planning/clusteringmessageorder.html">Clustering: Message ordering</a></li><li><a href="../Planning/clusteringmsgpolicyconsiderations.html">Clustering: Max Messages Behavior</a></li><li class="active"><a href="../Planning/clusteringclientstate.html">Clustering: Client state</a></li><li><a href="../Planning/clusteringomping.html">Clustering: Testing multicast connectivity between servers in a cluster</a></li></ul></li><li><a href="../Planning/pl00002_.html">Capacity planning</a></li><li><a href="../Planning/pl00004.html">Performance planning</a></li><li><a href="../Planning/ov40001.html">High availability planning</a></li><li><a href="../Planning/pl00020.html">Connecting to an existing infrastructure</a></li></ul></li><li><a href="../QuickStartGuide/qsg10000.html">Installing Eclipse Amlen  </a></li><li><a href="../Upgrading/up00001_.html">Upgrading</a></li><li><a href="../Scenarios/sc00000_.html">End-to-end scenarios</a></li><li><a href="../Administering/ad00000_.html">Administering</a></li><li><a href="../AdministeringWebUI/ad00002_.html">Administering the Web UI</a></li><li><a href="../Bridge/br00010.html">Configuring the Bridge</a></li><li><a href="../Security/se00000_.html">Security</a></li><li><a href="../Monitoring/admin00008_.html">Monitoring and reporting</a></li><li><a href="../Backup/ba00000_.html">Backup and restore</a></li><li><a href="../Troubleshooting/tr10000_.html">Troubleshooting</a></li><li><a href="../Developing/develop_guide.html">Developing client applications</a></li><li><a href="../Reference/re00000_.html">Reference</a></li><li><a href="../glossary/glossary.html">Glossary</a></li></ul></li></ul></nav><main role="main"><article role="article" aria-labelledby="ariaid-title1">
<h1 class="title topictitle1" id="ariaid-title1">Clustering: Client state</h1>




<div class="body conbody"><p class="shortdesc">Ensure that MQTT clients that connect by specifying <code class="ph codeph">cleanSession=False</code> always connect to an assigned server in the cluster.</p>
<p class="p">The MQTT protocol allows clients to connect in one of two <code class="ph codeph">cleanSession</code> modes. If you specify <code class="ph codeph">cleanSession=True</code>, the subscriptions, and other state data that is kept while the client is connected, are deleted when the client disconnects. If you specify <code class="ph codeph">cleanSession=False</code>, the subscriptions, and other state data that is kept while the client is connected, are persisted when the client disconnects and resumed when the client reconnects; however, the data is persisted only on the server to which the client was connected and is not sent to other servers in the cluster.</p>
<p class="p">If you need a client that was connected with a setting of <code class="ph codeph">cleanSession=False</code> to resume the state that it left after it disconnected, ensure that the client reconnects to the same server in the cluster. The client can then receive messages on subscriptions that were published while it was disconnected and resolve the state of messages that it published. </p>
<div class="p">Ensure that MQTT clients that connect specifying <code class="ph codeph">cleanSession=False</code> always connect to an assigned server in the cluster. The assignment of such a server in the cluster can be achieved either if each client remembers which server it must connect to, or by the use of an intelligent load balancer. The load balancer can direct clients that are specified <code class="ph codeph">cleanSession=True</code> to any server in the cluster, and direct clients that are specified <code class="ph codeph">cleanSession=False</code> to the same server perhaps by using the specified client identifier to determine which server is the client's assigned server. <div class="note note note_note"><span class="note__title">Note:</span>  If a client that connected with a setting of <code class="ph codeph">cleanSession=False</code> subsequently reconnects with a setting of <code class="ph codeph">cleanSession=True</code>, the first time that it reconnects, the load balancer should connect the client to the server that it was assigned to when it was specified with <code class="ph codeph">cleanSession=False</code>. The load balancer can subsequently direct the client to any server in the cluster. </div></div>
</div>
<nav role="navigation" class="related-links"><div class="familylinks"><div class="parentlink"><strong>Parent topic:</strong> <a class="link" href="../Planning/clusteringconsiderations.html" title="Key points to consider if you are planning to use clustering in your Eclipse Amlen solution.">Clustering considerations</a></div></div><div class="linklist relconcepts"><strong>Related concepts</strong><br><ul class="linklist"><li class="linklist"><a class="link" href="../Overview/ov00150_.html">Clustering in <span class="ph">Eclipse Amlen</span></a></li><li class="linklist"><a class="link" href="../Developing/devmqttapp.html">Developing MQTT applications</a></li></ul></div></nav>
</article></main></body></html>