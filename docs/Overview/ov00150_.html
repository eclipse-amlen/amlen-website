<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-us"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="copyright" content="(C) Copyright 2021"><meta name="generator" content="DITA-OT"><meta name="description" content="You can use clusters of Eclipse Amlen servers to permit a greater number of connections than would be possible on a single server and allow a greater throughput of messaging traffic. Clustering extends the scope of topic trees beyond the limit of a single server; a common topic space is created in which messages are received by subscribers regardless of the server on which they are published provided that the subscribers are using MQTT non-shared subscriptions."><link rel="stylesheet" type="text/css" href="../commonltr.css"><link rel="stylesheet" type="text/css" href="../doc.css"><title>Clustering in Eclipse Amlen</title></head><body id="ov00150_"><nav role="toc"><ul><li><a href="../welcome.html">Welcome</a></li><li><a href="../Overview/ov00000_.html">Eclipse Amlen</a><ul><li><a href="../Overview/ov00000_.html">Product overview</a><ul><li><a href="../Overview/ov00002_.html">Architecture Overview</a></li><li><a href="../Overview/ov60000_.html">Eclipse Amlen in Containers</a></li><li><a href="../Overview/ov00050.html">Supported protocols</a></li><li><a href="../Bridge/br00000.html">   Amlen Bridge</a></li><li><a href="../Overview/ov00003_.html">Key Concepts</a><ul><li><a href="../Overview/ov20000.html">Point-to-point messaging</a></li><li><a href="../Overview/ov00030.html">Publish/Subscribe</a></li><li><a href="../Planning/ov00102_.html">Message delivery</a></li><li><a href="../Planning/ov00101_.html">Messaging patterns</a></li><li><a href="../Overview/ov00060.html">Message hubs, endpoints, and policies</a></li><li class="active"><a href="../Overview/ov00150_.html">Clustering in Eclipse Amlen</a></li><li><a href="../Overview/ov00140_.html">Disconnected client notifications</a></li><li><a href="../Overview/ov00070.html">MQ Connectivity</a></li><li><a href="../Overview/ov40000.html">High availability</a></li><li><a href="../Bridge/br00001.html">   Amlen Bridge concepts</a></li></ul></li><li><a href="../Overview/accessibility_topic.html">Accessibility features for Eclipse Amlen</a></li><li><a href="../Overview/notices.html">Notices</a></li></ul></li><li><a href="../Planning/pl00001_.html">Planning</a></li><li><a href="../QuickStartGuide/qsg10000.html">Installing Eclipse Amlen  </a></li><li><a href="../Upgrading/up00001_.html">Upgrading</a></li><li><a href="../Scenarios/sc00000_.html">End-to-end scenarios</a></li><li><a href="../Administering/ad00000_.html">Administering</a></li><li><a href="../AdministeringWebUI/ad00002_.html">Administering the Web UI</a></li><li><a href="../Bridge/br00010.html">Configuring the Bridge</a></li><li><a href="../Security/se00000_.html">Security</a></li><li><a href="../Monitoring/admin00008_.html">Monitoring and reporting</a></li><li><a href="../Backup/ba00000_.html">Backup and restore</a></li><li><a href="../Troubleshooting/tr10000_.html">Troubleshooting</a></li><li><a href="../Developing/develop_guide.html">Developing client applications</a></li><li><a href="../Reference/re00000_.html">Reference</a></li><li><a href="../glossary/glossary.html">Glossary</a></li></ul></li></ul></nav><main role="main"><article role="article" aria-labelledby="ariaid-title1">
<h1 class="title topictitle1" id="ariaid-title1">Clustering in <span class="ph">Eclipse Amlen</span></h1>




<div class="body conbody"><p class="shortdesc">You can use clusters of <span class="ph">Eclipse Amlen</span> servers to permit a greater number of connections than would be possible on a single server and allow a greater throughput of messaging traffic. Clustering extends the scope of topic trees beyond the limit of a single server; a common topic space is created in which messages are received by subscribers regardless of the server on which they are published provided that the subscribers are using MQTT non-shared subscriptions. </p>
<p class="p">By connecting multiple <span class="ph">Eclipse Amlen</span> servers together on a local high-speed LAN to form a cluster, you can scale the maximum messaging throughput or the maximum number of concurrent connections beyond the capacity of a single <span class="ph">Eclipse Amlen</span> server. All <span class="ph">Eclipse Amlen</span> servers in a cluster share a common topic space which means that messages published on a particular topic are received by clients that are using MQTT non-shared subscriptions and subscribed to that topic regardless of which server they are connected to. Clients that use JMS, MQ Connectivity, or shared subscriptions can receive messages that are published only on the server on which the clients subscribe. For more information about shared subscriptions, see <a class="xref" href="../../com.ibm.ism.doc/Developing/devsharedsubscriptions.html">Shared subscriptions</a>. </p>
<p class="p">Clustering of <span class="ph">Eclipse Amlen</span> servers is of particular use in Internet of Things (IoT) applications where there are large numbers of devices or simple applications that publish and subscribe to a small number of data center applications. In such scenarios, the devices or simple applications typically use MQTT and non-shared subscriptions; the data center applications are more likely to use JMS, MQ Connectivity, or shared subscriptions.</p>
<section class="section"><h2 class="title sectiontitle">Cluster configuration</h2>

<p class="p">The following diagram shows a simple clustering configuration. There are two <span class="ph">Eclipse Amlen</span> servers in the cluster that is routing messages to and from the devices and simple applications that are using MQTT and non-shared subscriptions and also to and from the data center applications that are using shared subscriptions. A load balancer makes the cluster appear as a single server to clients and ensures that they connect to the correct server. </p>
<div class="p">
<br><img class="image" src="MSClustering01_v2.jpg" alt=""><br>
</div>
<p class="p">A server finds other servers in the cluster by using multicast discovery, or by specifying a known subset of the other servers in the cluster. Each server is a peer of all other servers in the cluster. The control channel sends subscription information and other related information to all servers in the cluster; the same control information is sent to all the servers in the cluster. In addition, a messaging channel is created from each server to each of the other servers in the cluster. Only messages that might be needed on the remote server are sent on the messaging channel.</p>
<p class="p">In the simple configuration that is illustrated in the diagram, the devices and simple applications use non-shared subscriptions to subscribe to topics in the common topic space. These devices and applications receive messages from the other devices, simple applications, and data center applications that publish messages to those topics regardless of the server that they are connected to. </p>
            <p class="p">Data center applications use shared subscriptions to subscribe to topics. Shared subscriptions do not participate in the common topic space. Therefore, each data center application receives only those messages that are published to the same server to which that data center is connected. It is good practice, therefore, to connect your data center applications to every server in the cluster. </p>
<p class="p">For more information about configuring a cluster, see <a class="xref" href="../../com.ibm.ism.doc/Administering/ad00940_.html">Configuring the cluster
membership of an <span class="ph">Eclipse Amlen</span> server</a>.</p>
</section>
<section class="section"><h2 class="title sectiontitle">Application support</h2>

<p class="p">While direct device-to-device messaging is fully supported in a cluster, the more common scenario for Internet of Things messaging is to route messages between devices and applications. An application can use non-shared subscriptions to publish and subscribe to topics in the common topic space of the cluster. However, many data center applications use other protocols and shared subscriptions. Such applications receive only those messages for topics to which they subscribe, and only if the messages are published on the server to which they are connected.</p>
<p class="p">When such data center applications are used in a cluster, you need to configure them to subscribe on each of the servers in the cluster. Consequently, the data center applications can get messages for topics to which they are subscribed, regardless of the server on which the messages are published. This configuration improves the performance of the cluster by not routing messages that are destined for applications that support shared subscriptions. </p>
            <p class="p">If the data center application publishes a message, that message is routed to all servers that have an MQTT non-shared subscription on the published topic. The data center application therefore does not need to know which server subscribers are connected to. </p>
</section>
</div>
</article></main></body></html>